import{a as z}from"./chunk-2YE6EGPP.js";import{a as D}from"./chunk-RW7VTZ2W.js";import{a as V}from"./chunk-Z24TDD3R.js";import{a as L}from"./chunk-P6ILIK54.js";import{a as q}from"./chunk-JANLSDFQ.js";import{a as R}from"./chunk-6ZI4JPIT.js";import"./chunk-I5FS3M5K.js";import{a as B}from"./chunk-OMGKDOXE.js";import{a as U}from"./chunk-7QLNNFJM.js";import"./chunk-2LEHSMYE.js";import{e as S,n as A,t as y}from"./chunk-XJFT56VC.js";import{$a as m,Da as h,Ha as I,Ma as b,Sa as p,Ta as O,Ua as k,Za as o,_a as r,aa as v,ba as _,ca as w,cb as x,da as C,fb as u,gb as c,ja as T,ob as l,pb as M,qb as d,wb as f,xb as g,ya as s}from"./chunk-IDPMWJG7.js";function G(n,t){if(n&1){let e=x();o(0,"app-classic-button",20),u("click",function(){v(e);let a=c();return _(a.addFriend.emit())}),l(1),f(2,"translate"),r()}n&2&&(s(),d(" ",g(2,1,"profile.addFriend")," "))}function W(n,t){n&1&&(o(0,"app-classic-button",21),l(1),f(2,"translate"),r()),n&2&&(s(),d(" ",g(2,1,"profile.edit")," "))}var E=class n{user;isOwnProfile=!1;postsCount=0;addFriend=new T;getFriendsCount(){return this.user?.friendsId?.length||0}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=I({type:n,selectors:[["app-profile-view"]],inputs:{user:"user",isOwnProfile:"isOwnProfile",postsCount:"postsCount"},outputs:{addFriend:"addFriend"},decls:42,vars:14,consts:[[1,"profile-container"],[1,"background-image-section"],[1,"bottom-section"],[1,"profile-image"],[1,"info-container"],[1,"info-x"],[1,"info-a"],[1,"information"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","fill","var(--color-primary)","viewBox","0 0 16 16",1,"bi","bi-person-fill","text-white","dark:text-indigo-300"],["d","M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"],[1,"info-b"],["id","phone","viewBox","0 0 24 24","fill","var(--color-primary)","height","20","width","20","xmlns","http://www.w3.org/2000/svg"],["d","M0 0h24v24H0V0z","fill","none"],["d","M19.23 15.26l-2.54-.29c-.61-.07-1.21.14-1.64.57l-1.84 1.84c-2.83-1.44-5.15-3.75-6.59-6.59l1.85-1.85c.43-.43.64-1.03.57-1.64l-.29-2.52c-.12-1.01-.97-1.77-1.99-1.77H5.03c-1.13 0-2.07.94-2 2.07.53 8.54 7.36 15.36 15.89 15.89 1.13.07 2.07-.87 2.07-2v-1.73c.01-1.01-.75-1.86-1.76-1.98z"],["fill","var(--color-primary)","height","20","width","20","id","globe","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg"],["data-name","Layer 2"],["data-name","globe","d","M22 12A10 10 0 0 0 12 2a10 10 0 0 0 0 20 10 10 0 0 0 10-10zm-2.07-1H17a12.91 12.91 0 0 0-2.33-6.54A8 8 0 0 1 19.93 11zM9.08 13H15a11.44 11.44 0 0 1-3 6.61A11 11 0 0 1 9.08 13zm0-2A11.4 11.4 0 0 1 12 4.4a11.19 11.19 0 0 1 3 6.6zm.36-6.57A13.18 13.18 0 0 0 7.07 11h-3a8 8 0 0 1 5.37-6.57zM4.07 13h3a12.86 12.86 0 0 0 2.35 6.56A8 8 0 0 1 4.07 13zm10.55 6.55A13.14 13.14 0 0 0 17 13h2.95a8 8 0 0 1-5.33 6.55z"],[1,"interact-buttons"],["size","small",3,"click",4,"ngIf"],["size","small",4,"ngIf"],["size","small",3,"click"],["size","small"]],template:function(e,i){e&1&&(o(0,"div",0),m(1,"div",1),o(2,"div",2),m(3,"div",3),o(4,"div",4)(5,"h1"),m(6,"strong"),l(7),r(),o(8,"div",5)(9,"div",6)(10,"p",7)(11,"strong"),l(12),f(13,"translate"),r(),l(14),r(),o(15,"p",7),w(),o(16,"svg",8),m(17,"path",9),r(),l(18),r(),C(),o(19,"p",7)(20,"strong"),l(21,"#Ps(icon):"),r(),l(22),r()(),o(23,"div",10)(24,"p",7),w(),o(25,"svg",11),m(26,"path",12)(27,"path",13),r(),C(),o(28,"strong"),l(29),f(30,"translate"),r(),l(31),r(),o(32,"p",7),w(),o(33,"svg",14)(34,"g",15),m(35,"path",16),r()(),C(),o(36,"strong"),l(37," RUC:"),r(),l(38),r()()(),o(39,"div",17),b(40,G,3,3,"app-classic-button",18)(41,W,3,3,"app-classic-button",19),r()()()()),e&2&&(s(7),M(i.user.username),s(5),d(" ",g(13,10,"profile.email"),":"),s(2),d(" ",i.user.email," "),s(4),d(" ",i.getFriendsCount()," "),s(4),d(" ",i.postsCount," "),s(7),d(" ",g(30,12,"profile.phone"),":"),s(2),d(" +51 ",i.user.phone,""),s(7),d(" ",i.user.rucEnterprise," "),s(2),p("ngIf",!i.isOwnProfile),s(),p("ngIf",i.isOwnProfile))},dependencies:[U,y,S],styles:[".profile-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.background-image-section[_ngcontent-%COMP%]{height:200px;background-image:url(https://picsum.photos/1200/300);background-size:cover;background-position:center;border-radius:0 0 10px 10px}.bottom-section[_ngcontent-%COMP%]{display:flex;padding:1rem;background-color:var(--color-secondary);color:var(--color-pure2);border-radius:0 0 10px 10px;transform:translateY(-40px)}.profile-image[_ngcontent-%COMP%]{width:10em;height:10em;border-radius:50%;background-image:url(https://picsum.photos/100);background-size:cover;background-position:center;margin-right:1rem;border:3px solid var(--color-pure2)}.info-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:space-between}.info-a[_ngcontent-%COMP%]{display:flex;gap:1rem}.info-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0}.interact-buttons[_ngcontent-%COMP%]{display:flex;margin-top:1rem;gap:1rem}.information[_ngcontent-%COMP%]{display:flex;gap:.2rem}"]})};var F=class{_id;username;email;password;phone;rucEnterprise;role;friendsId;friends;followers;following;registrationDate;lastLogin;constructor(t){this._id=t.id||t._id||"",this.username=t.username||"",this.email=t.email||"",this.password=t.password||"",this.phone=t.phone||"",this.rucEnterprise=t.rucEnterprise||"",this.role=t.role||"user",this.friendsId=t.friendsId||[],this.friends=t.friends||[],this.followers=t.followers||[],this.following=t.following||[],this.registrationDate=t.registrationDate||"",this.lastLogin=t.lastLogin||""}};function X(n,t){if(n&1){let e=x();o(0,"app-profile-view",7),u("addFriend",function(){v(e);let a=c();return _(a.handleAddFriendA())}),r()}if(n&2){let e=c();p("user",e.user)("isOwnProfile",e.isOwnProfile)("postsCount",e.posts.length)}}function Y(n,t){if(n&1){let e=x();o(0,"div")(1,"app-post-list",8),u("likeToggled",function(a){v(e);let P=c();return _(P.handleToggleLike(a))}),r()()}if(n&2){let e=c();s(),p("posts",e.posts)}}function J(n,t){if(n&1){let e=x();o(0,"app-friend-list",11),u("addFriend",function(a){v(e);let P=c(2);return _(P.handleAddFriendB(a))}),r()}if(n&2){let e=c(2);p("friends",e.friends)("addedFriends",e.addedFriends)}}function K(n,t){n&1&&(o(0,"h2",12),l(1),f(2,"translate"),r()),n&2&&(s(),d(" ",g(2,1,"friends.noFriendsB")," "))}function Q(n,t){if(n&1&&(o(0,"div"),b(1,J,1,2,"app-friend-list",9)(2,K,3,3,"h2",10),r()),n&2){let e=c();s(),p("ngIf",e.friends.length>0),s(),p("ngIf",e.friends.length===0)}}var N=class n{constructor(t,e,i,a,P){this.route=t;this.userService=e;this.authService=i;this.postService=a;this.friendRequestService=P}activeTab="posts";user=null;isOwnProfile=!1;posts=[];friends=[];addedFriends=[];ngOnInit(){let t=this.route.snapshot.paramMap.get("id"),e=this.authService.getUserId();e?.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),console.log("\u{1F4CC} ID desde la ruta:",t),console.log("\u{1F464} ID del usuario logueado:",e);let i=t||e;if(!i){console.error("\u274C No se encontr\xF3 ID de usuario.");return}this.isOwnProfile=t===e,console.log("\u{1F9E0} \xBFEs su propio perfil?",this.isOwnProfile),this.userService.getById(i).subscribe({next:a=>{this.user=new F(a),console.log("\u2705 Usuario cargado:",this.user),this.loadUserPosts(i),this.loadFriends(i),e&&this.loadAddedFriends(e)},error:a=>{console.error("\u274C Error al cargar perfiil:",a)}})}loadFriends(t){this.userService.getFriendsByUserId(t).subscribe({next:e=>{this.friends=e,console.log("\u{1F465} Amigos cargados:",this.friends)},error:e=>{console.error("\u274C Error al cargar lista de amigos:",e)}})}loadAddedFriends(t){this.userService.getFriendsByUserId(t).subscribe({next:e=>{this.addedFriends=e,console.log("\u{1F465} Amigos agregados cargados:",this.addedFriends)},error:e=>{console.error("\u274C Error al cargar lista de amigos agregados:",e)}})}loadUserPosts(t){this.postService.getAllByParamId("userId",t).subscribe({next:e=>{this.posts=e.map(i=>new q(i)),console.log("\u{1F4DD} Posts del usuario:",this.posts)},error:e=>{console.error("\u274C Error al cargar posts del usuario:",e)}})}handleToggleLike(t){this.postService.toggleLike(t._id).subscribe({next:()=>{let e=this.authService.getUserId();if(!e)return;t.likes.includes(e)?(t.likes=t.likes.filter(a=>a!==e),t.likesCount--):(t.likes.push(e),t.likesCount++)},error:e=>{console.error("\u274C Error al alternar like:",e)}})}setTab(t){this.activeTab=t}handleAddFriendA(){if(!this.user)return;let t=this.authService.getUserId(),e=this.user._id;if(!t||!e){console.error("\u274C No se pudo obtener IDs para solicitud de amistad");return}this.friendRequestService.createRequest(t,e).subscribe({next:()=>{console.log("\u2705 Solicitud de amistad enviada")},error:i=>{console.error("\u274C Error al enviar solicitud de amistad:",i)}})}handleAddFriendB(t){let e=this.authService.getUserId(),i=t;if(!e||!i){console.error("\u274C No se pudo obtener IDs para solicitud de amistad");return}this.friendRequestService.createRequest(e,i).subscribe({next:()=>{console.log("\u2705 Solicitud de amistad enviada a",i)},error:a=>{console.error("\u274C Error al enviar solicitud de amistad:",a)}})}static \u0275fac=function(e){return new(e||n)(h(A),h(V),h(B),h(R),h(z))};static \u0275cmp=I({type:n,selectors:[["app-profile-page"]],decls:13,vars:15,consts:[[3,"user","isOwnProfile","postsCount","addFriend",4,"ngIf"],[1,"other-container"],[1,"other-buttons"],[1,"tab-button",3,"click"],[1,"underline"],[1,"tab-content"],[4,"ngIf"],[3,"addFriend","user","isOwnProfile","postsCount"],[3,"likeToggled","posts"],[3,"friends","addedFriends","addFriend",4,"ngIf"],["class","no-friends-message",4,"ngIf"],[3,"addFriend","friends","addedFriends"],[1,"no-friends-message"]],template:function(e,i){e&1&&(b(0,X,1,3,"app-profile-view",0),o(1,"div",1)(2,"div",2)(3,"button",3),u("click",function(){return i.setTab("posts")}),l(4),f(5,"translate"),r(),o(6,"button",3),u("click",function(){return i.setTab("friends")}),l(7),f(8,"translate"),r(),m(9,"div",4),r(),o(10,"div",5),b(11,Y,2,1,"div",6)(12,Q,3,2,"div",6),r()()),e&2&&(p("ngIf",i.user),s(3),k("active",i.activeTab==="posts"),s(),d(" ",g(5,11,"profile.posts")," "),s(2),k("active",i.activeTab==="friends"),s(),d(" ",g(8,13,"profile.friends")," "),s(2),O("transform",i.activeTab==="posts"?"translateX(0%)":"translateX(100%)"),s(2),p("ngIf",i.activeTab==="posts"),s(),p("ngIf",i.activeTab==="friends"))},dependencies:[L,E,D,S,y],styles:[".other-container[_ngcontent-%COMP%]{margin-top:-50px;padding:1rem;background-color:var(--color-secondary);color:var(--color-pure2);border-radius:10px}.other-buttons[_ngcontent-%COMP%]{display:flex;position:relative;border-bottom:2px solid var(--muted);margin-bottom:1rem}.tab-button[_ngcontent-%COMP%]{background:none;border:none;padding:10px 20px;cursor:pointer;font-weight:600;color:var(--muted);position:relative}.tab-button.active[_ngcontent-%COMP%]{color:var(--color-pure2)}.underline[_ngcontent-%COMP%]{position:absolute;bottom:0;height:3px;width:80px;background-color:var(--color-primary);transition:all .3s ease;transform:translate(0)}.tab-content[_ngcontent-%COMP%]{max-height:150px}.tab-panel[_ngcontent-%COMP%]{display:none}.tab-panel.active[_ngcontent-%COMP%]{display:block}"]})};export{N as ProfilePageComponent};
