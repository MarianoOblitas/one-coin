import{a as E}from"./chunk-P6ILIK54.js";import{a as D}from"./chunk-PXU6GBA3.js";import{b as P,d as S,f as y,i as _,n as x}from"./chunk-OYNSWCUO.js";import{a as w}from"./chunk-6ZI4JPIT.js";import{a as T}from"./chunk-I5FS3M5K.js";import{a as F}from"./chunk-OMGKDOXE.js";import{a as O}from"./chunk-7QLNNFJM.js";import{a as I}from"./chunk-2LEHSMYE.js";import{t as k,u as M}from"./chunk-XJFT56VC.js";import{$a as g,Da as m,Ha as c,Sa as d,Za as r,_a as n,fb as a,ja as b,ob as p,qb as C,wb as v,xb as h,ya as s}from"./chunk-IDPMWJG7.js";var u=class i{content=new y("");postSubmitted=new b;placeholderOptions=["post.placeholder.thinking","post.placeholder.feeling","post.placeholder.happening","post.placeholder.express"];selectedPlaceholder=this.placeholderOptions[Math.floor(Math.random()*this.placeholderOptions.length)];onSubmit(){let e=this.content.value?.trim();e&&(this.postSubmitted.emit(e),this.content.reset())}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=c({type:i,selectors:[["app-post-form"]],outputs:{postSubmitted:"postSubmitted"},decls:11,vars:7,consts:[[1,"post-form-container"],[1,"form-content"],["rows","3",3,"formControl","placeholder"],[1,"form-footer"],["type","image"],["size","small",3,"click"]],template:function(t,o){t&1&&(r(0,"div",0),g(1,"app-avatar"),r(2,"div",1)(3,"textarea",2),v(4,"translate"),p(5,"    "),n(),r(6,"div",3),g(7,"app-icon-button",4),r(8,"app-classic-button",5),a("click",function(){return o.onSubmit()}),p(9),v(10,"translate"),n()()()()),t&2&&(s(3),d("formControl",o.content)("placeholder",h(4,3,o.selectedPlaceholder)),s(6),C(" ",h(10,5,"post.submit")," "))},dependencies:[O,x,P,S,_,I,T,M,k],styles:[".post-form-container[_ngcontent-%COMP%]{display:flex;padding:1rem;background-color:var(--color-secondary);gap:1rem;width:100%;flex-direction:row;border-bottom:1px solid var(--color-primary)}.form-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.5rem}textarea[_ngcontent-%COMP%]{resize:none;padding:.75rem;font-family:Montserrat,sans-serif;font-size:1rem;border:none;border-radius:10px;background-color:var(--color-secondary);color:var(--color-primary);outline:none}textarea[_ngcontent-%COMP%]::placeholder{font-weight:500}.form-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-top:1px solid var(--muted);padding-top:.5rem}.icon-button[_ngcontent-%COMP%]{background-color:var(--color-primary);border:none;border-radius:50%;padding:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background-color .3s ease}.icon-button[_ngcontent-%COMP%]:hover{background-color:var(--muted)}"]})};var j=class i{constructor(e,t,o){this.postService=e;this.authService=t;this.commentService=o}posts=[];commentCounts=0;ngOnInit(){this.loadPosts()}loadPosts(){this.postService.getAll().subscribe({next:e=>{console.log("\u2705 Posts recibidos:",e),this.posts=e},error:e=>{console.error("\u274C Error al cargar posts:",e)}})}loadCommentCount(e){return this.commentService.getAllByParamId("postId",e).subscribe({next:t=>{let o=t.length;this.commentCounts=o},error:t=>{console.error(`\u274C Error al cargar comentarios del post ${e}:`,t),this.commentCounts=0}}),this.commentCounts}onPostSubmit(e){let t={title:"Nuevo post",content:e,images:["https://imgur.com/abc.jpg"],tags:["novedad","foto"],privacy:"friends",location:{name:"Lima",coordinates:[-12.0464,-77.0428]}};this.postService.create(t).subscribe({next:o=>{console.log("\u2705 Post creado:",o),this.posts.unshift(o)},error:o=>{console.error("\u274C Error al crear post:",o)}})}handleToggleLike(e){this.postService.toggleLike(e._id).subscribe({next:()=>{let t=this.authService.getUserId();if(!t)return;e.likes.includes(t)?(e.likes=e.likes.filter(l=>l!==t),e.likesCount--):(e.likes.push(t),e.likesCount++)},error:t=>{console.error("\u274C Error al dar like al post:",t)}})}static \u0275fac=function(t){return new(t||i)(m(w),m(F),m(D))};static \u0275cmp=c({type:i,selectors:[["app-feed-page"]],decls:4,vars:1,consts:[[1,"feed-page-container"],[3,"postSubmitted"],[3,"likeToggled","posts"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"app-post-form",1),a("postSubmitted",function(f){return o.onPostSubmit(f)}),n(),r(2,"app-post-list",2),a("likeToggled",function(f){return o.handleToggleLike(f)}),n(),p(3,` />
`),n()),t&2&&(s(2),d("posts",o.posts))},dependencies:[u,E],styles:[".avatar[_ngcontent-%COMP%]{flex-shrink:0;width:50px;height:50px;border-radius:50%;border:2px solid var(--color-primary);padding:.5rem;overflow:hidden;display:flex;align-items:center;justify-content:center}"]})};export{j as FeedPageComponent};
